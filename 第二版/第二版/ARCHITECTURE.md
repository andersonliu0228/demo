# EA è‡ªå‹•åŒ–è·Ÿå–®ç³»çµ±å¾Œç«¯ - æ¶æ§‹èªªæ˜

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹æ¦‚è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ¶/å‰ç«¯æ‡‰ç”¨                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS/HTTP
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FastAPI æ‡‰ç”¨ç¨‹å¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    API Layer (è·¯ç”±å±¤)                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚  â”‚  Credential    â”‚  â”‚   Exchange     â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚    Routes      â”‚  â”‚    Routes      â”‚                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 Service Layer (æ¥­å‹™é‚è¼¯å±¤)                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Crypto  â”‚  â”‚Credentialâ”‚  â”‚ Exchange â”‚  â”‚  Cache  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Repository Layer (è³‡æ–™å­˜å–å±¤)                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚      User        â”‚  â”‚    Credential    â”‚              â”‚   â”‚
â”‚  â”‚  â”‚   Repository     â”‚  â”‚   Repository     â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL  â”‚    â”‚    Redis     â”‚    â”‚     CCXT     â”‚
â”‚   Database   â”‚    â”‚    Cache     â”‚    â”‚  (Exchanges) â”‚
â”‚              â”‚    â”‚              â”‚    â”‚              â”‚
â”‚  - users     â”‚    â”‚  - æ†‘è­‰å¿«å–   â”‚    â”‚  - Binance   â”‚
â”‚  - api_creds â”‚    â”‚  - äº¤æ˜“æ‰€åˆ—è¡¨ â”‚    â”‚  - OKX       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  - Bybit     â”‚
                                        â”‚  - ç­‰ 8 å€‹    â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç›®éŒ„çµæ§‹è©³è§£

```
ea-trading-backend/
â”‚
â”œâ”€â”€ ğŸ“‚ backend/                    # å¾Œç«¯æ‡‰ç”¨ç¨‹å¼
â”‚   â”œâ”€â”€ ğŸ“‚ app/                    # æ ¸å¿ƒæ‡‰ç”¨ç¨‹å¼ç¢¼
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ models/             # è³‡æ–™æ¨¡å‹ï¼ˆORMï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py           # User æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ api_credential.py # ApiCredential æ¨¡å‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ repositories/       # è³‡æ–™å­˜å–å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ user_repository.py
â”‚   â”‚   â”‚   â””â”€â”€ credential_repository.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ services/           # æ¥­å‹™é‚è¼¯å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ crypto_service.py      # åŠ å¯†æœå‹™
â”‚   â”‚   â”‚   â”œâ”€â”€ cache_service.py       # å¿«å–æœå‹™
â”‚   â”‚   â”‚   â”œâ”€â”€ exchange_service.py    # äº¤æ˜“æ‰€æœå‹™
â”‚   â”‚   â”‚   â””â”€â”€ credential_service.py  # æ†‘è­‰æœå‹™
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ routes/             # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ credential_routes.py
â”‚   â”‚   â”‚   â””â”€â”€ exchange_routes.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ schemas/            # Pydantic DTOs
â”‚   â”‚   â”‚   â””â”€â”€ credential_schemas.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ config.py             # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ database.py           # è³‡æ–™åº«é…ç½®
â”‚   â”‚   â””â”€â”€ main.py               # FastAPI å…¥å£
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ tests/                  # æ¸¬è©¦ä»£ç¢¼
â”‚       â”œâ”€â”€ ğŸ“‚ services/           # æœå‹™å±¤æ¸¬è©¦
â”‚       â”‚   â”œâ”€â”€ test_crypto_service.py
â”‚       â”‚   â”œâ”€â”€ test_crypto_service_properties.py
â”‚       â”‚   â”œâ”€â”€ test_cache_service_properties.py
â”‚       â”‚   â””â”€â”€ test_exchange_service.py
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“‚ repositories/       # Repository æ¸¬è©¦
â”‚       â”‚   â”œâ”€â”€ test_user_repository.py
â”‚       â”‚   â””â”€â”€ test_credential_repository.py
â”‚       â”‚
â”‚       â””â”€â”€ conftest.py           # pytest é…ç½®
â”‚
â”œâ”€â”€ ğŸ“‚ alembic/                    # è³‡æ–™åº«é·ç§»
â”‚   â”œâ”€â”€ versions/                 # é·ç§»è…³æœ¬
â”‚   â”‚   â””â”€â”€ 001_initial_schema.py
â”‚   â”œâ”€â”€ env.py                    # é·ç§»ç’°å¢ƒ
â”‚   â””â”€â”€ script.py.mako            # é·ç§»æ¨¡æ¿
â”‚
â”œâ”€â”€ ğŸ“‚ docker/                     # Docker é…ç½®
â”‚   â””â”€â”€ entrypoint.sh             # å®¹å™¨å•Ÿå‹•è…³æœ¬
â”‚
â”œâ”€â”€ ğŸ“‚ scripts/                    # è¼”åŠ©è…³æœ¬
â”‚   â”œâ”€â”€ generate_encryption_key.py
â”‚   â””â”€â”€ init_db.py
â”‚
â”œâ”€â”€ ğŸ“‚ .kiro/specs/                # Spec æ–‡ä»¶
â”‚   â””â”€â”€ ea-trading-backend/
â”‚       â”œâ”€â”€ requirements.md       # éœ€æ±‚æ–‡ä»¶
â”‚       â”œâ”€â”€ design.md            # è¨­è¨ˆæ–‡ä»¶
â”‚       â””â”€â”€ tasks.md             # ä»»å‹™åˆ—è¡¨
â”‚
â”œâ”€â”€ ğŸ“„ Dockerfile                  # Docker æ˜ åƒé…ç½®
â”œâ”€â”€ ğŸ“„ docker-compose.yml          # Docker Compose é…ç½®
â”œâ”€â”€ ğŸ“„ requirements.txt            # Python ä¾è³´
â”œâ”€â”€ ğŸ“„ pyproject.toml             # å°ˆæ¡ˆé…ç½®
â”œâ”€â”€ ğŸ“„ alembic.ini                # Alembic é…ç½®
â”œâ”€â”€ ğŸ“„ .env.example               # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ ğŸ“„ .gitignore                 # Git å¿½ç•¥è¦å‰‡
â”‚
â””â”€â”€ ğŸ“„ æ–‡æª”/
    â”œâ”€â”€ README.md                 # å®Œæ•´ä½¿ç”¨æŒ‡å—
    â”œâ”€â”€ GET_STARTED.md            # å¿«é€Ÿé–‹å§‹
    â”œâ”€â”€ QUICK_START.md            # 5 åˆ†é˜å•Ÿå‹•
    â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md # å¯¦ä½œç¸½çµ
    â”œâ”€â”€ PROJECT_STATUS.md         # å°ˆæ¡ˆç‹€æ…‹
    â”œâ”€â”€ DELIVERY_CHECKLIST.md     # äº¤ä»˜æ¸…å–®
    â””â”€â”€ ARCHITECTURE.md           # æœ¬æ–‡ä»¶
```

## ğŸ”„ è³‡æ–™æµç¨‹

### 1. å‰µå»ºæ†‘è­‰æµç¨‹

```
ç”¨æˆ¶è«‹æ±‚
   â”‚
   â–¼
POST /api/v1/credentials
   â”‚
   â–¼
Credential Routes (credential_routes.py)
   â”‚
   â”œâ”€â–º é©—è­‰è«‹æ±‚åƒæ•¸ (Pydantic)
   â”‚
   â–¼
Credential Service (credential_service.py)
   â”‚
   â”œâ”€â–º Exchange Service: é©—è­‰æ†‘è­‰
   â”‚   â””â”€â–º CCXT: é€£æ¥äº¤æ˜“æ‰€
   â”‚
   â”œâ”€â–º Crypto Service: åŠ å¯† API Secret
   â”‚   â””â”€â–º Fernet AES-256 åŠ å¯†
   â”‚
   â”œâ”€â–º Credential Repository: å­˜å„²æ†‘è­‰
   â”‚   â””â”€â–º PostgreSQL: å¯«å…¥è³‡æ–™åº«
   â”‚
   â””â”€â–º Cache Service: æ¸…é™¤å¿«å–
       â””â”€â–º Redis: åˆªé™¤èˆŠå¿«å–
   â”‚
   â–¼
è¿”å›æ†‘è­‰è³‡è¨Šï¼ˆAPI Key å·²é®è”½ï¼‰
```

### 2. æŸ¥è©¢æ†‘è­‰æµç¨‹

```
ç”¨æˆ¶è«‹æ±‚
   â”‚
   â–¼
GET /api/v1/credentials
   â”‚
   â–¼
Credential Routes
   â”‚
   â–¼
Credential Service
   â”‚
   â”œâ”€â–º Cache Service: å˜—è©¦å¾å¿«å–ç²å–
   â”‚   â””â”€â–º Redis: æŸ¥è©¢å¿«å–
   â”‚       â”œâ”€â–º å‘½ä¸­ âœ“ â†’ è¿”å›å¿«å–è³‡æ–™
   â”‚       â””â”€â–º æœªå‘½ä¸­ âœ— â†’ ç¹¼çºŒ
   â”‚
   â”œâ”€â–º Credential Repository: å¾è³‡æ–™åº«æŸ¥è©¢
   â”‚   â””â”€â–º PostgreSQL: è®€å–è³‡æ–™
   â”‚
   â””â”€â–º Cache Service: æ›´æ–°å¿«å–
       â””â”€â–º Redis: å¯«å…¥å¿«å–ï¼ˆTTL: 5åˆ†é˜ï¼‰
   â”‚
   â–¼
è¿”å›æ†‘è­‰åˆ—è¡¨ï¼ˆAPI Key å·²é®è”½ï¼‰
```

### 3. é©—è­‰æ†‘è­‰æµç¨‹

```
ç”¨æˆ¶è«‹æ±‚
   â”‚
   â–¼
POST /api/v1/exchange/verify
   â”‚
   â–¼
Exchange Routes
   â”‚
   â–¼
Exchange Service
   â”‚
   â”œâ”€â–º å‰µå»º CCXT äº¤æ˜“æ‰€å¯¦ä¾‹
   â”‚
   â”œâ”€â–º å˜—è©¦ç²å–å¸³æˆ¶é¤˜é¡
   â”‚   â””â”€â–º CCXT: å‘¼å«äº¤æ˜“æ‰€ API
   â”‚       â”œâ”€â–º æˆåŠŸ âœ“ â†’ æ†‘è­‰æœ‰æ•ˆ
   â”‚       â””â”€â–º å¤±æ•— âœ— â†’ æ†‘è­‰ç„¡æ•ˆ
   â”‚
   â””â”€â–º æª¢æŸ¥äº¤æ˜“æ¬Šé™
       â””â”€â–º CCXT: å˜—è©¦ç²å–é–‹æ”¾è¨‚å–®
   â”‚
   â–¼
è¿”å›é©—è­‰çµæœ
```

## ğŸ” å®‰å…¨æ©Ÿåˆ¶

### 1. åŠ å¯†å­˜å„²

```
æ˜æ–‡ API Secret
   â”‚
   â–¼
Crypto Service
   â”‚
   â”œâ”€â–º è®€å–åŠ å¯†é‡‘é‘°ï¼ˆç’°å¢ƒè®Šæ•¸ï¼‰
   â”‚
   â”œâ”€â–º Fernet.encrypt()
   â”‚   â””â”€â–º AES-256 å°ç¨±åŠ å¯†
   â”‚
   â–¼
åŠ å¯†çš„ API Secret
   â”‚
   â–¼
å­˜å„²åˆ° PostgreSQL
```

### 2. API Key é®è”½

```
åŸå§‹ API Key: "abcdefghijklmnopqrstuvwxyz"
   â”‚
   â–¼
mask_api_key(show_chars=4)
   â”‚
   â–¼
é®è”½å¾Œ: "abcd...wxyz"
```

### 3. æ¬Šé™æª¢æŸ¥

```
API è«‹æ±‚
   â”‚
   â”œâ”€â–º æå– user_idï¼ˆå¾èªè­‰ä»¤ç‰Œï¼‰
   â”‚
   â”œâ”€â–º Repository æŸ¥è©¢æ™‚é©—è­‰ user_id
   â”‚   â””â”€â–º åªè¿”å›è©²ç”¨æˆ¶çš„è³‡æ–™
   â”‚
   â””â”€â–º é˜²æ­¢è¶Šæ¬Šè¨ªå•
```

## ğŸš€ æ•ˆèƒ½å„ªåŒ–

### 1. éåŒæ­¥ I/O

```python
# æ‰€æœ‰è³‡æ–™åº«æ“ä½œéƒ½æ˜¯éåŒæ­¥çš„
async def get_user_credentials(user_id: int):
    credentials = await credential_repo.get_user_credentials(user_id)
    return credentials
```

### 2. é€£æ¥æ± 

```python
# SQLAlchemy é€£æ¥æ± é…ç½®
engine = create_async_engine(
    DATABASE_URL,
    pool_size=10,        # é€£æ¥æ± å¤§å°
    max_overflow=20,     # æœ€å¤§æº¢å‡ºé€£æ¥
    pool_pre_ping=True,  # é€£æ¥å‰æª¢æŸ¥
)
```

### 3. Redis å¿«å–

```
ç¬¬ä¸€æ¬¡æŸ¥è©¢: è³‡æ–™åº« â†’ å¿«å– â†’ è¿”å›ï¼ˆæ…¢ï¼‰
å¾ŒçºŒæŸ¥è©¢: å¿«å– â†’ è¿”å›ï¼ˆå¿«ï¼‰
TTL éæœŸ: é‡æ–°å¾è³‡æ–™åº«è¼‰å…¥
```

### 4. é™ç´šè™•ç†

```
Redis å¯ç”¨: ä½¿ç”¨å¿«å–ï¼ˆå¿«é€Ÿï¼‰
   â”‚
   â–¼
Redis å¤±æ•—: é™ç´šåˆ°è³‡æ–™åº«ï¼ˆä»å¯ç”¨ï¼‰
   â”‚
   â””â”€â–º ä¸æ‹‹å‡ºç•°å¸¸ï¼Œä¿è­‰æœå‹™å¯ç”¨æ€§
```

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### 1. å–®å…ƒæ¸¬è©¦

```
æ¸¬è©¦å–®å€‹å‡½æ•¸/æ–¹æ³•
   â”‚
   â”œâ”€â–º æ¸¬è©¦æ­£å¸¸æƒ…æ³
   â”œâ”€â–º æ¸¬è©¦é‚Šç·£æƒ…æ³
   â””â”€â–º æ¸¬è©¦éŒ¯èª¤è™•ç†
```

### 2. å±¬æ€§æ¸¬è©¦ï¼ˆHypothesisï¼‰

```
ç”Ÿæˆéš¨æ©Ÿæ¸¬è©¦è³‡æ–™
   â”‚
   â”œâ”€â–º åŸ·è¡Œ 100 æ¬¡è¿­ä»£
   â”‚
   â”œâ”€â–º é©—è­‰é€šç”¨å±¬æ€§
   â”‚   â””â”€â–º ä¾‹å¦‚ï¼šåŠ å¯†å¾Œè§£å¯† = åŸå§‹å€¼
   â”‚
   â””â”€â–º ç™¼ç¾é‚Šç·£æƒ…æ³
```

### 3. æ•´åˆæ¸¬è©¦

```
æ¸¬è©¦å¤šå€‹å…ƒä»¶å”ä½œ
   â”‚
   â”œâ”€â–º API â†’ Service â†’ Repository â†’ Database
   â”‚
   â””â”€â–º é©—è­‰ç«¯åˆ°ç«¯æµç¨‹
```

## ğŸ“Š è³‡æ–™åº«è¨­è¨ˆ

### Users è¡¨

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    hashed_password VARCHAR(255) NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### API Credentials è¡¨

```sql
CREATE TABLE api_credentials (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    exchange_name VARCHAR(50) NOT NULL,
    api_key VARCHAR(255) NOT NULL,
    encrypted_api_secret TEXT NOT NULL,
    encrypted_passphrase TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    last_verified_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT uq_user_exchange_key UNIQUE (user_id, exchange_name, api_key)
);
```

### é—œä¿‚

```
users (1) â”€â”€â”€â”€â”€â”€< (N) api_credentials
  â”‚                      â”‚
  â””â”€ ä¸€å€‹ç”¨æˆ¶            â””â”€ å¤šå€‹æ†‘è­‰
     å¯ä»¥æœ‰å¤šå€‹æ†‘è­‰
```

## ğŸ”Œ å¤–éƒ¨æ•´åˆ

### CCXT äº¤æ˜“æ‰€

```
æ”¯æ´çš„äº¤æ˜“æ‰€:
â”œâ”€ Binance
â”œâ”€ OKX
â”œâ”€ Bybit
â”œâ”€ Huobi
â”œâ”€ KuCoin
â”œâ”€ Gate.io
â”œâ”€ Bitget
â””â”€ MEXC

åŠŸèƒ½:
â”œâ”€ é©—è­‰ API Key
â”œâ”€ ç²å–å¸³æˆ¶é¤˜é¡
â”œâ”€ æª¢æŸ¥äº¤æ˜“æ¬Šé™
â””â”€ çµ±ä¸€çš„ API ä»‹é¢
```

## ğŸ³ Docker æ¶æ§‹

```
docker-compose.yml
   â”‚
   â”œâ”€â–º PostgreSQL å®¹å™¨
   â”‚   â”œâ”€ ç«¯å£: 5432
   â”‚   â”œâ”€ å·: postgres_data
   â”‚   â””â”€ å¥åº·æª¢æŸ¥: pg_isready
   â”‚
   â”œâ”€â–º Redis å®¹å™¨
   â”‚   â”œâ”€ ç«¯å£: 6379
   â”‚   â”œâ”€ å·: redis_data
   â”‚   â””â”€ å¥åº·æª¢æŸ¥: redis-cli ping
   â”‚
   â””â”€â–º Backend å®¹å™¨
       â”œâ”€ ç«¯å£: 8000
       â”œâ”€ ä¾è³´: postgres, redis
       â”œâ”€ å•Ÿå‹•: entrypoint.sh
       â”‚   â”œâ”€ ç­‰å¾…è³‡æ–™åº«å°±ç·’
       â”‚   â”œâ”€ åŸ·è¡Œ Alembic é·ç§»
       â”‚   â””â”€ å•Ÿå‹• FastAPI
       â””â”€ å·: ä»£ç¢¼ç›®éŒ„ï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰
```

## ğŸ¯ è¨­è¨ˆåŸå‰‡

### 1. åˆ†å±¤æ¶æ§‹
- **é—œæ³¨é»åˆ†é›¢**ï¼šæ¯å±¤è² è²¬ç‰¹å®šè·è²¬
- **ä¾è³´æ³¨å…¥**ï¼šé¬†è€¦åˆï¼Œæ˜“æ–¼æ¸¬è©¦
- **å–®ä¸€è·è²¬**ï¼šæ¯å€‹é¡åˆ¥åªåšä¸€ä»¶äº‹

### 2. å®‰å…¨å„ªå…ˆ
- **åŠ å¯†å­˜å„²**ï¼šæ•æ„Ÿè³‡è¨ŠåŠ å¯†
- **é‡‘é‘°åˆ†é›¢**ï¼šç’°å¢ƒè®Šæ•¸ç®¡ç†
- **æ¬Šé™æª¢æŸ¥**ï¼šé˜²æ­¢è¶Šæ¬Šè¨ªå•

### 3. é«˜æ•ˆèƒ½
- **éåŒæ­¥ I/O**ï¼šæé«˜ä¸¦ç™¼èƒ½åŠ›
- **é€£æ¥æ± **ï¼šé‡ç”¨è³‡æ–™åº«é€£æ¥
- **å¿«å–æ©Ÿåˆ¶**ï¼šæ¸›å°‘è³‡æ–™åº«è² è¼‰

### 4. å¯ç¶­è­·æ€§
- **æ¸…æ™°çµæ§‹**ï¼šæ˜“æ–¼ç†è§£å’Œä¿®æ”¹
- **å®Œæ•´æ¸¬è©¦**ï¼šä¿è­‰ä»£ç¢¼å“è³ª
- **è©³ç´°æ–‡æª”**ï¼šé™ä½å­¸ç¿’æˆæœ¬

## ğŸ“ˆ æ“´å±•æ€§

### æ°´å¹³æ“´å±•

```
Load Balancer
   â”‚
   â”œâ”€â–º Backend Instance 1
   â”œâ”€â–º Backend Instance 2
   â””â”€â–º Backend Instance 3
       â”‚
       â”œâ”€â–º Shared PostgreSQL
       â””â”€â–º Shared Redis
```

### å‚ç›´æ“´å±•

```
å¢åŠ è³‡æº:
â”œâ”€ CPU æ ¸å¿ƒæ•¸
â”œâ”€ è¨˜æ†¶é«”å¤§å°
â”œâ”€ è³‡æ–™åº«é€£æ¥æ± 
â””â”€ Redis å¿«å–å¤§å°
```

---

**æç¤º**ï¼šé€™ä»½æ¶æ§‹æ–‡ä»¶æä¾›äº†ç³»çµ±çš„æ•´é«”è¦–åœ–ã€‚å¦‚éœ€äº†è§£å…·é«”å¯¦ä½œç´°ç¯€ï¼Œè«‹æŸ¥çœ‹ç›¸æ‡‰çš„ä»£ç¢¼æ–‡ä»¶å’Œæ–‡æª”ã€‚
